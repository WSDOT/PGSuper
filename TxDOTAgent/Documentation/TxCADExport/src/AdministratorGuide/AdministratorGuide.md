Adminstrator Guide {#adminstrator_guide}
============

Background
----------
PGSuper creates Excel worksheets directly using Excel’s OLE C++ interface.  Floating point numbers can be exported into Excel cells using full precision since formatting and positioning of text can take place within Excel. 

Excel files generated by PGSuper are created from pre-defined excel templates (*.xltx files). Separate template files exist for harped (I-girder) and straight strand designs. The templates contain defined named cell ranges that serve as targets for the PGSuper data. Columns for each range in the template have pre-defined formatting to ensure that text is placed and displayed properly. Text alignment and cell padding can be adjusted within the Excel templates to place text precisely. The use of Excel templates alleviates the need to modify PGSuper’s C++ code when minor changes are made to table formats, and even relative column positions can be switched around.

Customization - Template Files
-----------------
Most of the CAD Export's behavior is hard-coded in C++, however formatting and ordering and locations of columns in the exported Excel spreadsheets can be controlled via modification of the two Excel template files outlined below. Template files are installed in a folder named "TxCADExport" under the main BridgeLink installation folder.

* CADExport-Harped.xltx - This file is used for I Girders (i.e., Tx Girders and AASHTO PCI girders).

* CADExport-Straight.xltx - This file is used for all girder types other than I Girders.

Named Ranges in Excel Templates
---------------------------------
To define a target location the cell at the top row of each target column is identified by an Excel named range (see https://support.office.com/en-us/article/define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64 for more information). This allows the PGSuper export to find the top target cell’s location and the rows below it.

The tables below show the exact names of the target ranges expected in the Excel templates. Failure to define any of the ranges will result in an error message.

Range Names and Contents of Harped Strand Template Data
-------------------------------------------------------

Range Name | Units | Description
---------- | ----- | -----------
StructureName | text | Taken from Bridge ID in PGSuper project properties
SpanNum | int | Span number
GdrNum | int | Girder number
GdrType | text | Name of girder library entry for girder in question
NonStd | text | Blank for standard strand patterns. In the form “*,**,***” referring to the row in the Non-Standard strands table showing NS information
NStot | int | Total number of strands in girder
Size | Text | Strand size
Strength | Ksi | Strand strength
eCL | inch | Eccentricity of all strands at mid-span at BSS3
eEnd | Inch | Eccentricity of all strands at girder ends at BSS3
NH | int | Number of harped strands. Left blank for all straight designs.
ToEnd | inch | Yb of topmost draped strand at girder ends. Left blank for all straight designs.
FCI | Ksi | Initial concrete strength at release
FC | Ksi | Final 28 day concrete strength
fComp | Ksi | Max applied compressive stress along girder at BSS3, Service I
fTens | Ksi | Max applied tensile stress along girder at BSS3, Service III
UltMom | kip-ft | Max applied moment along girder at BSS3, Strength I
gMoment | float | Live load distribution factor for moment
gShear | float | Live load distribution factor for shear
RFStr1Inventory | float | Rating factor, Strength I Inventory. Minimum of shear and moment RF's
RFStr1Operating | float | Rating factor, Strength I Operating. Minimum of shear and moment RF's
RFSvc3Inventory | float | Rating factor, Service III Inventory. Stress

Range Names and Contents of Straight Strand Template Data
---------------------------------------------------------

Range Name | Units | Description
---------- | ----- | -----------
StructureName | text | Taken from Bridge ID in PGSuper project properties
SpanNum | int | Span number
GdrNum | int | Girder number
GdrType | text | Name of girder library entry for girder in question
NonStd | text | Blank for standard strand patterns. In the form “*,**,***” referring to the row in the Non-Standard strands table showing NS information
NStot | int | Total number of strands in girder
Size | Text | Strand size
Strength | Ksi | Strand strength
eCL | inch | Eccentricity of all strands at mid-span at BSS3
eEnd | Inch | Eccentricity of all strands at girder ends at BSS3
NDBtot | int | Total number of debonded strands
DBBotDist | inch | Distance from bottom of girder to row of debonded strands
NSRow |  | Total number of strands in debonded row
NDBRow |  | Number of strands debonded in row
DB_3 |  | Number of strands debonded in row at 3 ft
DB_6 |  | Number of strands debonded in row at 6 ft
DB_9 |  | Number of strands debonded in row at 9 ft
DB_12 |  | Number of strands debonded in row at 12 ft
DB_15 |  | Number of strands debonded in row at 15 ft
FCI | Ksi | Initial concrete strength at release
FC | Ksi | Final 28 day concrete strength
fComp | Ksi | Max applied compressive stress along girder at BSS3, Service I
fTens | Ksi | Max applied tensile stress along girder at BSS3, Service III
UltMom | kip-ft | Max applied moment along girder at BSS3, Strength I
gMoment | float | Live load distribution factor for moment
gShear | float | Live load distribution factor for shear
RFStr1Inventory | float | Rating factor, Strength I Inventory. Minimum of shear and moment RF's
RFStr1Operating | float | Rating factor, Strength I Operating. Minimum of shear and moment RF's
RFSvc3Inventory | float | Rating factor, Service III Inventory. Stress

Range Names and Contents of Non-Standard Table Template Data
--------------------------------

Range Name | Units | Description
---------- | ----- | -----------
NSPattern | text | In form: *, **, ***,... referred from the main strand table from a designated girder having a non-standard strand pattern.
NSArrangement | Text | In form: “2.5(ABCE)” or “2.5(10)” see details in section 3.5.1

Range Names and Contents of Haunch and Deflections Table Template Data
--------------------------------

Range Name | Units | Description
---------- | ----- | -----------
SpanNo | text | Span number
BeamNo | text | Girder number
X_Val | Inches | "X" dimension as defined on TxDOT plan sheets
Y_Val | Inches | "Y" dimension as defined on TxDOT plan sheets
Z_Val | Inches | "Z" dimension as defined on TxDOT plan sheets
A_Val | Feet | "A" dimension as defined on TxDOT plan sheets
B_Val | Feet | "B" dimension as defined on TxDOT plan sheets
SKA_Val | Feet | Deflection due to Shear Key load at 1/4 points
SKB_Val | Feet | Deflection due to Shear Key load at mid-span

Semicolon-separated Text Files
---------
There are no user options to modify the data written to this format. All options are hard-coded in C++. Layout of the file is based on the most recent template files.

Other Information
-----------------------
-----------------------
The TxDOT CAD Data Export feature is installed with the main BridgeLink installation when the TxDOT Extensions are selected . The exporter itself is part of the TxDOTAgent.dll which is installed in the same folder with BridgeLink's files. The default installation folder for BridgeLink is "C:\Program Files\WSDOT\BridgeLink". However, this location may be changed by the user at installation time.

Registry Values for Testing Excel Template Files
----------------------
 If desired, end users can modify the location for the Excel template files used during CAD export. It is expected that this feature will only be used for testing and development of template file modifications.
 
 The CAD exporter looks for the Excel template files in the folder identified by the string value pair **TxCADExportTemplateFolder** located at following registry location:
 
     Computer\HKEY_CURRENT_USER\Software\Washington State Department of Transportation\BridgeLink\Settings
  
  > Tip: Use the Windows RegEdit application to delete the string value "TxCADExportTemplateFolder" to return PGSuper back to its default (factory) behavior.

